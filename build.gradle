/*
 * This file was generated by the Gradle 'init' task.
 */

plugins {
  id 'java-library'
  id 'maven-publish'
  id "com.google.protobuf" version "0.9.2"
}

repositories {
  mavenLocal()
  maven {
    url = uri('https://repo.maven.apache.org/maven2/')
  }
}

def beam_version = "2.48.0"
def flink_version = "1.15.4"
def grpc_version = "1.45.1"
def protobuf_version = "3.19.4"
def hamcrest_version = "2.2"
def log4j_version = "2.17.1"
def jupiter_version = "5.7.1"

configurations {
  testAnnotationProcessor.extendsFrom annotationProcessor
  testCompileOnly.extendsFrom compileOnly
}

dependencies {
  api 'com.google.guava:guava:31.0.1-jre'
  api "org.apache.beam:beam-sdks-java-core:${beam_version}"
  api "com.google.protobuf:protobuf-java:${protobuf_version}"
  api "io.grpc:grpc-core:${grpc_version}"
  api "io.grpc:grpc-stub:${grpc_version}"
  api "io.grpc:grpc-protobuf:${grpc_version}"
  api "io.grpc:grpc-netty:${grpc_version}"
  api 'com.datastax.cassandra:cassandra-driver-core:3.11.0'
  api 'org.slf4j:slf4j-api:1.7.30'
  api "org.apache.beam:beam-runners-flink-1.15:${beam_version}"
  api "org.apache.flink:flink-clients:${flink_version}"
  api "org.apache.flink:flink-streaming-java:${flink_version}"
  api "org.apache.flink:flink-statebackend-rocksdb:${flink_version}"
  api 'javax.annotation:javax.annotation-api:1.3.2'
  api "org.apache.logging.log4j:log4j-slf4j-impl:${log4j_version}"
  api "org.apache.logging.log4j:log4j-core:${log4j_version}"
  api 'com.codahale.metrics:metrics-core:3.0.2'
  testImplementation "org.apache.beam:beam-runners-direct-java:${beam_version}"
  testImplementation 'org.junit.jupiter:junit-jupiter-params:5.7.1'
  testImplementation "org.hamcrest:hamcrest-core:${hamcrest_version}"
  testImplementation "org.hamcrest:hamcrest-library:${hamcrest_version}"
  testImplementation "org.junit.jupiter:junit-jupiter-api:${jupiter_version}"
  testImplementation "org.junit.jupiter:junit-jupiter-params:${jupiter_version}"
  testImplementation "org.junit.jupiter:junit-jupiter-engine:${jupiter_version}"
  compileOnly 'org.projectlombok:lombok:1.18.22'
  compileOnly 'com.google.auto.service:auto-service:1.0'
  annotationProcessor 'org.projectlombok:lombok:1.18.22'
  annotationProcessor 'com.google.auto.service:auto-service:1.0'
}

group = 'cz.datadriven.beam'
version = '1.0-SNAPSHOT'
description = 'beam-transaction'
java.sourceCompatibility = JavaVersion.VERSION_11

protobuf {
  protoc { artifact = "com.google.protobuf:protoc:${protobuf_version}" }
  plugins {
    grpc { artifact = "io.grpc:protoc-gen-grpc-java:${grpc_version}" }
  }
  generateProtoTasks {
    all()*.plugins { grpc {} }
  }
}

publishing {
  publications {
    maven(MavenPublication) {
        from(components.java)
    }
  }
}

tasks.withType(JavaCompile) {
  options.encoding = 'UTF-8'
}

tasks.withType(Javadoc) {
  options.encoding = 'UTF-8'
}

test {
  useJUnitPlatform()
}
